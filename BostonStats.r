library(MASS)
library(car)
data(Boston)
print(names(Boston))
print(head(Boston))
# fix(Boston)
print(summary(Boston))
write.csv(Boston, "Boston.csv", row.names = F)
attach(Boston)
lm.fit=lm(medv~lstat)
print(summary(lm.fit))
print(names(lm.fit))
print(coef(lm.fit))
print(confint(lm.fit))
print(predict(lm.fit,data.frame(lstat=(c(5,10,15))), interval="confidence"))
print(predict(lm.fit,data.frame(lstat=(c(5,10,15))), interval="prediction"))
pdf("BostonStats.pdf")
plot(lstat,medv,col="blue",pch=10)
abline(lm.fit)
abline(lm.fit,lwd=5,col="red")
plot(1:25,1:25,pch=1:25)
par(mfrow=c(2,2))
plot(lm.fit)
plot(predict(lm.fit), residuals(lm.fit))
plot(hatvalues(lm.fit), rstudent(lm.fit))
lm.fit=lm(medv~., data=Boston)
print(summary(lm.fit))
lm.fit1=lm(medv~.-age-indus, data=Boston)
print(summary(lm.fit1))
print(vif(lm.fit))
print(vif(lm.fit1))
lm.fit1=update(lm.fit, ~.-age-indus-tax)
print(summary(lm.fit1))
print(vif(lm.fit1))
lm.fit1=update(lm.fit, ~.-age-indus-tax-zn)
print(summary(lm.fit1, correlation=T))
print(vif(lm.fit1))
lm.fit1=update(lm.fit, ~.-age-indus-tax-zn-crim)
print(summary(lm.fit1, correlation=T))
print(vif(lm.fit1))
lm.fit1=update(lm.fit, ~.-age-indus-tax-zn-crim-rad)
print(summary(lm.fit1, correlation=T))
print(vif(lm.fit1))
print(summary(lm(medv~lstat*age, data=Boston)))
lm.fit2=lm(medv~lstat+I(lstat^2), data=Boston)
print(summary(lm.fit2))
lm.fit=lm(medv~lstat)
print(anova(lm.fit,lm.fit2))
par(mfrow=c(2,2))
plot(lm.fit2)
lm.fit5=lm(medv~poly(lstat,5))
print(summary(lm.fit5))
plot(lm.fit5)
lm.fit6=lm(medv~log(lstat)+I(rm^2)+rm+log(ptratio)+chas+I(nox^3)+log(dis)+black, data=Boston)
print(summary(lm.fit6))
plot(lm.fit6)
print(vif(lm.fit6))
dev.off()
#lm.fit5=lm(medv~sqrt(dis)+exp(dis)+log(dis)+poly(dis,5))
#print(summary(lm.fit5))
