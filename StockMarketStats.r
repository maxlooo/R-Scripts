library(ISLR)
print(names(Smarket))
print(head(Smarket))
print(dim(Smarket))
print(summary(Smarket))
pdf("StockMarketStats.pdf")
pairs(Smarket)
print(cor(Smarket[,-9]))
attach(Smarket)
plot(Volume)
glm.fits=glm(Direction~Lag1+Lag2+Volume,data=Smarket,family=binomial)
print(summary(glm.fits))
glm.probs=predict(glm.fits,type="response")
print(glm.probs[1:10])
print(contrasts(Direction))
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
print(table(glm.pred,Direction))
print(mean(glm.pred==Direction))
train=(Year<2005)
Smarket.2005=Smarket[!train,]
print(dim(Smarket.2005))
Direction.2005=Direction[!train]
glm.fits=glm(Direction~Lag1+Lag2+Volume,data=Smarket,family=binomial,subset=train)
glm.probs=predict(glm.fits,Smarket.2005,type="response")
glm.pred=rep("Down",252)
glm.pred[glm.probs>.5]="Up"
print(table(glm.pred,Direction.2005))
print(mean(glm.pred==Direction.2005))
print(mean(glm.pred!=Direction.2005))
glm.fits=glm(Direction~Lag1+Lag2,data=Smarket,family=binomial,subset=train)
glm.probs=predict(glm.fits,Smarket.2005,type="response")
glm.pred=rep("Down",252)
glm.pred[glm.probs>.5]="Up"
print(table(glm.pred,Direction.2005))
print(mean(glm.pred==Direction.2005))
print(106/(106+76))
#predict specific day stock market results based on specific previous lag1 and lag2
print(predict(glm.fits,newdata=data.frame(Lag1=c(1.2,1.5),Lag2=c(1.1,-0.8)),type="response"))
library(MASS)
lda.fit=lda(Direction~Lag1+Lag2,data=Smarket,subset=train)
print(lda.fit)
plot(lda.fit)
lda.pred=predict(lda.fit, Smarket.2005)
print(names(lda.pred))
lda.class=lda.pred$class
print(table(lda.class,Direction.2005))
print(mean(lda.class==Direction.2005))
#lda.class "Down" posterior prob is >=.5
print(sum(lda.pred$posterior[,1]>=.5))
print(sum(lda.pred$posterior[,1]<.5))
print(max(lda.pred$posterior[,1]))
print(min(lda.pred$posterior[,1]))
qda.fit=qda(Direction~Lag1+Lag2,data=Smarket,subset=train)
print(qda.fit)
qda.class=predict(qda.fit,Smarket.2005)$class
print(table(qda.class,Direction.2005))
print(mean(qda.class==Direction.2005))

dev.off()
